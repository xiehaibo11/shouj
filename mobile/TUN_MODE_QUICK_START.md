# TUN模式快速开始指南

## 什么是TUN模式？

TUN模式（虚拟网卡模式）是一种透明代理方式，无需配置系统代理，所有应用流量自动通过Clash处理。

## 为什么需要下载依赖？

TUN模式需要**规则数据库**来判断哪些流量需要代理：
- **GeoIP.dat**: IP地址规则（约5MB）
- **GeoSite.dat**: 域名规则（约2MB）
- **Country.mmdb**: 地理位置数据库（约6MB）

## 使用步骤

### 1️⃣ 下载规则数据（首次必需）

1. 打开应用，进入**"设置"**页面
2. 找到**"TUN模式"**，点击右侧⚙️设置图标
3. 看到GeoData状态卡片显示**"需要下载规则数据"**
4. 点击**"下载"**按钮（或**"CDN"**按钮使用加速源）
5. 等待下载完成，显示**"规则数据已就绪"**

> 💡 **提示**: 
> - 国内网络推荐使用**CDN**按钮下载，速度更快
> - 下载一次后永久可用，除非手动删除
> - 总下载大小约13MB，请确保网络畅通

### 2️⃣ 配置TUN参数（可选）

如果需要自定义TUN设置，可以调整以下参数：

#### 网络栈模式
- **gvisor** (推荐): Go语言实现，兼容性最好
- **system**: 使用系统网络栈，性能较好
- **mixed**: 混合模式

#### 路由设置
- **自动路由**: ✅ 推荐开启，自动配置路由表
- **严格路由**: 强制所有流量通过TUN（可能影响本地服务）
- **自动检测接口**: ✅ 推荐开启，自动选择网络接口

#### 高级设置
- **DNS劫持**: 默认 `any:53`，劫持DNS查询
- **MTU**: 默认 `1500`，一般无需修改

完成后点击**"保存"**。

### 3️⃣ 启用TUN模式

1. 返回"设置"页面
2. 打开**"TUN模式"**开关
3. 系统会弹出VPN连接请求，点击**"确定"**
4. 状态栏出现🔑图标，表示TUN模式已启用

### 4️⃣ 返回首页启动代理

1. 回到**"首页"**
2. 点击中央的**"启动"**按钮
3. 配置成功后，所有流量自动代理

## 常见问题

### Q1: 下载失败怎么办？
- 检查网络连接
- 尝试使用**"CDN"**按钮
- 关闭VPN后再下载

### Q2: 已下载，但显示"需要下载"？
- 点击信息图标查看文件路径
- 可能下载中断，重新下载即可

### Q3: 如何更新规则数据？
1. 进入TUN设置对话框
2. 点击**"更新"**按钮
3. 重新下载最新规则

### Q4: TUN模式和系统代理的区别？
| 功能 | TUN模式 | 系统代理 |
|------|---------|---------|
| 应用支持 | ✅ 所有应用 | ⚠️ 部分应用 |
| 配置难度 | ✅ 自动 | ⚠️ 需手动配置 |
| 性能 | ⚠️ 稍慢 | ✅ 较快 |
| 规则匹配 | ✅ 完整 | ✅ 完整 |

> 💡 **建议**: Android端推荐使用TUN模式，无需配置更便捷

### Q5: 可以删除规则数据吗？
可以，在TUN设置对话框中点击**"删除"**按钮，但需要重新下载才能使用TUN模式。

### Q6: 规则数据占用多少空间？
- GeoIP: ~5MB
- GeoSite: ~2MB
- Country.mmdb: ~6MB
- **总计**: ~13MB

### Q7: 多久需要更新一次规则？
建议**每月更新一次**，确保规则数据最新。

## 重置为默认设置

如果TUN配置出现问题：
1. 进入TUN设置对话框
2. 点击标题栏的**"重置"**按钮
3. 所有参数恢复为推荐值

## 技术支持

如遇问题，请提供以下信息：
- Android版本
- 下载失败的错误提示
- 文件路径（点击信息图标查看）
- 网络环境（WiFi/移动数据）

---

**祝使用愉快！** 🎉

