# 完整功能测试指南

## 🎯 测试目标

验证移动端所有已实现功能是否正常工作，与桌面端功能对标。

---

## ✅ 测试清单

### 1. 系统设置测试

#### 1.1 TUN模式完整测试 ⭐

**前提条件**: 首次测试

**测试步骤**:
1. 打开应用 → 点击右上角菜单 → 选择"设置"
2. 找到"TUN模式"，点击右侧⚙️设置图标
3. 验证GeoData状态卡片显示"需要下载规则数据"
4. 点击"下载"按钮
5. 验证下载进度显示：
   - ✅ "下载 GeoIP..." (0-33%)
   - ✅ "下载 GeoSite..." (33-66%)
   - ✅ "下载 Country.mmdb..." (66-100%)
   - ✅ "下载完成" (100%)
6. 验证状态变为"规则数据已就绪"

**备用测试**:
1. 点击"CDN"按钮（国内网络）
2. 验证CDN下载速度更快

**高级测试**:
1. 点击信息图标(ℹ️)
2. 验证文件信息对话框：
   - ✅ GeoIP: 存在、大小、路径
   - ✅ GeoSite: 存在、大小、路径
   - ✅ Country.mmdb: 存在、大小、路径
3. 关闭对话框

**配置测试**:
1. 修改Stack模式（gvisor → system → mixed）
2. 修改设备名称（Mihomo → MyTun）
3. 切换各项开关：
   - 自动路由 ON/OFF
   - 严格路由 ON/OFF
   - 自动检测接口 ON/OFF
4. 修改DNS劫持（any:53 → 8.8.8.8:53）
5. 修改MTU（1500 → 1400）
6. 点击"保存"
7. 重新打开TUN设置，验证配置已保存

**重置测试**:
1. 点击标题栏"重置"按钮
2. 验证所有参数恢复默认值
3. 点击"保存"

**删除测试**:
1. 点击"删除"按钮
2. 验证状态变为"需要下载规则数据"
3. 重新下载GeoData

**预期结果**:
- ✅ 下载成功，进度准确显示
- ✅ 文件信息正确（总大小约13MB）
- ✅ 配置保存成功
- ✅ 重置功能正常
- ✅ 删除功能正常

---

#### 1.2 系统代理测试

**测试步骤**:
1. 在设置页面找到"系统代理"
2. 切换开关 ON
3. 验证副标题变为"系统代理已启用"
4. 切换开关 OFF
5. 验证副标题变为"系统代理已禁用"

**预期结果**:
- ✅ 开关状态正确保存
- ⚠️ 实际代理功能待实现

---

#### 1.3 开机自启测试

**测试步骤**:
1. 切换"开机自启"开关 ON
2. 重启手机
3. 验证应用是否自动启动

**预期结果**:
- ✅ 设置保存成功
- ⚠️ 实际自启功能待实现

---

#### 1.4 静默启动测试

**测试步骤**:
1. 切换"静默启动"开关 ON
2. 手动启动应用
3. 验证是否无启动画面

**预期结果**:
- ✅ 设置保存成功
- ⚠️ 实际静默功能待实现

---

### 2. Clash设置测试

#### 2.1 局域网连接测试

**测试步骤**:
1. 切换"局域网连接"开关 ON
2. 验证状态保存
3. 切换 OFF
4. 验证状态保存

**预期结果**:
- ✅ 开关状态正确保存
- ⚠️ 需要应用到Clash核心

---

#### 2.2 DNS覆写测试

**测试步骤**:
1. 切换"DNS覆写"开关 ON
2. 验证副标题变为"使用自定义DNS配置"
3. 切换 OFF
4. 验证副标题变为"使用默认DNS配置"

**预期结果**:
- ✅ 开关状态正确保存
- ⚠️ 需要应用到Clash核心

---

#### 2.3 IPv6支持测试

**测试步骤**:
1. 切换"IPv6支持"开关 ON
2. 验证状态保存
3. 切换 OFF
4. 验证状态保存

**预期结果**:
- ✅ 开关状态正确保存
- ⚠️ 需要应用到Clash核心

---

#### 2.4 统一延迟测试

**测试步骤**:
1. 切换"统一延迟"开关 ON
2. 验证副标题变为"所有代理使用统一延迟测试"
3. 切换 OFF
4. 验证副标题变为"使用各代理独立延迟"

**预期结果**:
- ✅ 开关状态正确保存
- ⚠️ 需要应用到Clash核心

---

#### 2.5 日志等级测试

**测试步骤**:
1. 点击"日志等级"
2. 弹出对话框显示5个选项：
   - Debug
   - Info
   - Warn
   - Error
   - Silent
3. 依次选择每个选项
4. 验证副标题更新为选中的等级
5. 关闭设置页面，重新打开
6. 验证日志等级已保存

**预期结果**:
- ✅ 所有等级可选
- ✅ 设置持久化
- ⚠️ 需要应用到Clash核心

---

### 3. 端口设置测试

#### 3.1 混合端口测试

**测试步骤**:
1. 点击"混合端口"
2. 弹出输入对话框，默认值"7890"
3. 修改为"7891"
4. 点击"保存"
5. 验证副标题显示"7891"
6. 重新打开设置，验证端口已保存

**预期结果**:
- ✅ 端口可编辑
- ✅ 设置持久化
- ⚠️ 需要应用到Clash核心

---

#### 3.2 外部控制测试

**测试步骤**:
1. 点击"外部控制"
2. 弹出输入对话框，默认值"127.0.0.1:9090"
3. 修改为"0.0.0.0:9090"
4. 点击"保存"
5. 验证副标题显示"0.0.0.0:9090"

**预期结果**:
- ✅ 地址可编辑
- ✅ 设置持久化
- ⚠️ 需要应用到Clash核心

---

#### 3.3 网页界面测试

**测试步骤**:
1. 点击"网页界面"
2. 验证副标题显示"http://yacd.haishan.me"

**预期结果**:
- ✅ 显示正确
- ⚠️ 实际打开功能待实现

---

### 4. Clash内核测试

#### 4.1 核心版本测试

**测试步骤**:
1. 找到"Clash 内核"项
2. 验证副标题显示核心版本号
3. 如果显示"未初始化"，先启动代理
4. 再次检查版本号

**预期结果**:
- ✅ 显示正确的版心版本
- 或显示"未初始化"（核心未启动）

---

#### 4.2 更新GeoData测试

*（已在TUN模式测试中完成）*

---

### 5. 外观设置测试

#### 5.1 主题模式测试

**测试步骤**:
1. 点击"主题模式"
2. 弹出对话框显示3个选项：
   - 跟随系统
   - 浅色
   - 深色
3. 选择"深色"
4. 验证应用变为深色主题
5. 选择"浅色"
6. 验证应用变为浅色主题
7. 选择"跟随系统"
8. 验证随系统变化

**预期结果**:
- ✅ 主题可选
- ✅ 设置保存
- ⚠️ 实时切换待完善

---

### 6. 关于功能测试

#### 6.1 版本信息测试

**测试步骤**:
1. 点击"版本信息"
2. 弹出对话框显示：
   - 应用名称：Clash Verge Rev Mobile
   - 应用版本：x.x.x
   - Clash内核：版本号或"未初始化"
   - 包名：io.github.clash_verge_rev.clash_verge_rev.debug
3. 验证版本号正确
4. 点击"关闭"

**预期结果**:
- ✅ 所有信息显示正确
- ✅ 对话框可关闭

---

#### 6.2 Clash内核版本测试

**测试步骤**:
1. 找到"Clash 内核"项
2. 验证副标题显示核心版本

**预期结果**:
- ✅ 版本显示正确

---

#### 6.3 GitHub仓库测试

**测试步骤**:
1. 点击"GitHub 仓库"
2. 验证浏览器打开
3. 验证跳转到正确的仓库页面

**预期结果**:
- ✅ 成功打开浏览器
- ✅ 跳转到 github.com/clash-verge-rev/clash-verge-rev

---

#### 6.4 检查更新测试

**测试步骤**:
1. 点击"检查更新"
2. 验证副标题变为"检查中..."
3. 等待1秒
4. 弹出对话框显示"当前已是最新版本"
5. 点击"确定"

**预期结果**:
- ✅ 检查动画显示
- ✅ 对话框弹出
- ⚠️ 实际检查逻辑待实现

---

#### 6.5 开源许可测试

**测试步骤**:
1. 点击"开源许可"
2. 弹出对话框显示：
   - 许可证类型：GPL-3.0
   - 许可证说明
   - 依赖项列表（Clash Meta Core、Jetpack Compose等）
3. 滚动内容
4. 点击"关闭"

**预期结果**:
- ✅ 许可证信息正确
- ✅ 内容可滚动
- ✅ 对话框可关闭

---

## 🔍 配置持久化测试

### 测试目的
验证所有设置在应用重启后保持不变。

### 测试步骤
1. 修改所有可配置项：
   - TUN模式：ON
   - 系统代理：ON
   - 开机自启：ON
   - 静默启动：ON
   - 局域网连接：ON
   - DNS覆写：ON
   - IPv6支持：ON
   - 统一延迟：ON
   - 日志等级：Debug
   - 混合端口：7891
   - 外部控制：0.0.0.0:9090
   - 主题模式：深色
2. 完全关闭应用（滑动清除任务）
3. 重新打开应用
4. 进入设置页面
5. 验证所有设置保持不变

### 预期结果
- ✅ 所有设置正确保存
- ✅ 应用重启后保持

---

## 📱 UI响应测试

### 测试项目
1. ✅ 开关切换流畅
2. ✅ 对话框打开/关闭流畅
3. ✅ 列表滚动流畅
4. ✅ 输入响应及时
5. ✅ 主题切换流畅

### 性能要求
- 开关响应：< 100ms
- 对话框动画：< 300ms
- 滚动帧率：60fps
- 内存占用：< 200MB

---

## 🐛 边界测试

### 1. 输入验证
- [ ] 混合端口输入非数字
- [ ] 混合端口输入超出范围（0-65535）
- [ ] 外部控制输入无效格式
- [ ] DNS劫持输入无效格式
- [ ] MTU输入非数字

### 2. 网络异常
- [ ] GeoData下载时断网
- [ ] GeoData下载时切换网络
- [ ] 检查更新时断网

### 3. 存储异常
- [ ] 存储空间不足时下载GeoData
- [ ] 权限不足时保存配置

### 4. 并发操作
- [ ] 快速连续切换开关
- [ ] 同时打开多个对话框
- [ ] 下载GeoData时切换页面

---

## 📊 测试报告模板

### 测试环境
- 设备型号：____________
- Android版本：____________
- 应用版本：____________
- 测试日期：____________

### 测试结果汇总

| 模块 | 测试项 | 通过 | 失败 | 未测 | 备注 |
|-----|--------|------|------|------|------|
| 系统设置 | TUN模式 | ☐ | ☐ | ☐ | |
| 系统设置 | 系统代理 | ☐ | ☐ | ☐ | |
| 系统设置 | 开机自启 | ☐ | ☐ | ☐ | |
| 系统设置 | 静默启动 | ☐ | ☐ | ☐ | |
| Clash设置 | 局域网连接 | ☐ | ☐ | ☐ | |
| Clash设置 | DNS覆写 | ☐ | ☐ | ☐ | |
| Clash设置 | IPv6支持 | ☐ | ☐ | ☐ | |
| Clash设置 | 统一延迟 | ☐ | ☐ | ☐ | |
| Clash设置 | 日志等级 | ☐ | ☐ | ☐ | |
| 端口设置 | 混合端口 | ☐ | ☐ | ☐ | |
| 端口设置 | 外部控制 | ☐ | ☐ | ☐ | |
| 端口设置 | 网页界面 | ☐ | ☐ | ☐ | |
| Clash内核 | 核心版本 | ☐ | ☐ | ☐ | |
| Clash内核 | 更新GeoData | ☐ | ☐ | ☐ | |
| 外观设置 | 主题模式 | ☐ | ☐ | ☐ | |
| 关于 | 版本信息 | ☐ | ☐ | ☐ | |
| 关于 | GitHub | ☐ | ☐ | ☐ | |
| 关于 | 检查更新 | ☐ | ☐ | ☐ | |
| 关于 | 开源许可 | ☐ | ☐ | ☐ | |

### 问题记录

| 编号 | 严重程度 | 问题描述 | 复现步骤 | 预期结果 | 实际结果 |
|-----|---------|---------|---------|---------|---------|
| 1 | | | | | |
| 2 | | | | | |
| 3 | | | | | |

### 测试总结
- 总测试项：____
- 通过：____
- 失败：____
- 通过率：____%

---

## 🎉 快速烟雾测试（5分钟）

如果时间有限，执行以下核心测试：

1. ✅ 打开设置页面
2. ✅ TUN模式下载GeoData（选CDN）
3. ✅ 修改几个设置并保存
4. ✅ 重启应用验证持久化
5. ✅ 打开版本信息对话框
6. ✅ 点击GitHub仓库链接

**如果这些都正常，基本功能OK！** 👍

